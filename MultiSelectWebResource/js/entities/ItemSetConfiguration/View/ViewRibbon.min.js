var AdvancedMultiSelect=window.AdvancedMultiSelect||{__namespace:!0};AdvancedMultiSelect.ItemSetConfiguration=AdvancedMultiSelect.ItemSetConfiguration||{__namespace:!0};AdvancedMultiSelect.ItemSetConfiguration.View=function(){var n=function(n){if(n.length===0){Xrm.Utility.alertDialog("Please select record(s) first.");return}var t=function(){var t=xrmjQuery.Deferred(),i={SelectedIds:n.join(",")};return CrmWebApiFacade.ExecuteAction("pavelkh_ItemSetConfigurationExport",i).then(function(n){var i=n.Configuration;t.resolve(i)},function(n){t.reject(n)}),t.promise()},i=function(n){var i=new Blob([n],{type:"text/plain;charset=utf-8;"}),r="AdvancedMultiSelect.cfg",t,u;navigator.msSaveBlob?navigator.msSaveBlob(i,r):(t=document.createElement("a"),t.download!==undefined&&(u=URL.createObjectURL(i),t.setAttribute("href",u),t.setAttribute("download",r),t.style.visibility="hidden",document.body.appendChild(t),t.click(),document.body.removeChild(t)))};t().then(function(n){i(n)},function(n){Xrm.Utility.alertDialog("An error occured while exporting configuration.\nDetails:\n"+n.message)})},t=function(){Xrm.Utility.openWebResource("pavelkh_/html/ExportConfigurations/import.html",null,800,450)};return{ExportConfiguration:n,ImportConfiguration:t}}();